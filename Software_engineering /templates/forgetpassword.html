<!DOCTYPE html>
<html lang="en">

<head>
    {% load static %}
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- 引入css文件 -->
    <link rel="stylesheet" href="{% static 'css/login.css' %}">
    <!-- 引入jquery -->
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <title>登录</title>
</head>

<body>
    <!-- 最外层的大盒子 -->
    <div class="box">
        <!-- 滑动盒子 -->
        <div class="pre-box">
            <h1>WELCOME</h1>
            <div class="img-box">
                <img src="{% static 'img/waoku.jpg' %}" alt="">
            </div>
        </div>
        <!-- 注册盒子 -->
        <div class="register-form">
            <!-- 标题盒子 -->
            <div class="title-box">
                <h1>注册</h1>
            </div>
            {% if messages %}
                <ul class="messages">
                    {% for message in messages %}
                        <li class="{{ message.tags }}">{{ message }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        </div>
        <!-- 登录盒子 -->
        <div class="login-form">
            <!-- 标题盒子 -->
            <div class="title-box">
                <h1>找回密码</h1>
            </div>
            <!-- 输入框盒子 -->
            <form action="{% url 'forgetpassword' %}" method="post">
                {% csrf_token %}
                <div class="input-box">
                    {{ form.username }}
                    {{ form.question }}
                    {{ form.answer }}
                    {{ form.password }}
                </div>
                <!-- 按钮盒子 -->
                <div class="btn-box">
                    <button type="submit">确认</button>
                    <p onclick="goLogin()" class="switch-link right-small">回到登入</p>
                </div>
            </form>
        </div>
    </div>

    <script>
       function goLogin() {
            // Redirect to the forget password page
            window.location.href = '{% url 'login' %}';
        }

        // Function to display error alert and refresh the form
        const showAlertAndRefresh = (message) => {
            alert(message);
            location.reload();
        }
        {% if messages %}
            {% for message in messages %}
                {% if message.tags == 'error' %}
                    showAlertAndRefresh("{{ message }}");
                {% endif %}
            {% endfor %}
        {% endif %}
    </script>
    <script>
           const bubleCreate = () => {
        // 获取body元素
        const body = document.body;
        // 创建泡泡元素
        const buble = document.createElement('span');
        // 设置泡泡半径
        let r = Math.random() * 5 + 25; // 半径大小为25~30
        // 设置泡泡的宽高
        buble.style.width = r + 'px';
        buble.style.height = r + 'px';
        // 设置泡泡的随机起点
        buble.style.left = Math.random() * innerWidth + 'px';

        // 检查泡泡是否生成在带有 'no-bubble' 类的元素或其子元素上
        const noBubbleElements = document.querySelectorAll('.nobubble');
        let isInsideNoBubbleElement = false;
        noBubbleElements.forEach(element => {
            const rect = element.getBoundingClientRect();
            if (buble.style.left > rect.left && buble.style.left < rect.right) {
                isInsideNoBubbleElement = true;
            }
        });

        // 如果泡泡不在 'no-bubble' 元素上，添加泡泡到 body
        if (!isInsideNoBubbleElement) {
            body.append(buble);
            // 4秒后清除泡泡
            setTimeout(() => {
                buble.remove();
            }, 4000);
        }
    };

    // 每200毫秒生成一个泡泡
    setInterval(() => {
        bubleCreate();
    }, 200);
</script>
    <style>
        .form-container {
            margin-top: -50px; /* 向上移动 50 像素，可以根据需要调整 */
            position: relative;
        }
    </style>

</body>

</html>